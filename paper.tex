%-----------------------------------------------------------------------------
%
%               Template for sigplanconf LaTeX Class
%
% Name:         sigplanconf-template.tex
%
% Purpose:      A template for sigplanconf.cls, which is a LaTeX 2e class
%               file for SIGPLAN conference proceedings.
%
% Guide:        Refer to "Author's Guide to the ACM SIGPLAN Class,"
%               sigplanconf-guide.pdf
%
% Author:       Paul C. Anagnostopoulos
%               Windfall Software
%               978 371-2316
%               paul@windfall.com
%
% Created:      15 February 2005
%
%-----------------------------------------------------------------------------


\documentclass[numbers,preprint]{sigplanconf}

% The following \documentclass options may be useful:

% preprint       Remove this option only once the paper is in final form.
%  9pt           Set paper in  9-point type (instead of default 10-point)
% 11pt           Set paper in 11-point type (instead of default 10-point).
% numbers        Produce numeric citations with natbib (instead of default author/year).
% authorversion  Prepare an author version, with appropriate copyright-space text.

\usepackage{amsmath}
\usepackage{caption}
\usepackage{color}
\usepackage{listings}
\usepackage{url}

\newcommand{\cL}{{\cal L}}
\newcommand{\langname}{Trinity}
\newcommand{\moduleview}{module}
\newcommand{\Moduleview}{Module}

\definecolor{gray}{RGB}{128, 128, 128}

\lstdefinestyle{modulestyle}{
	aboveskip=0pt,
	belowskip=-10pt,
	basicstyle=\footnotesize\ttfamily,
	captionpos=b,
	columns=flexible,
	float=t,
	frame=single,
	keywordstyle=\color{blue},
	numbers=left,
	numberstyle=\color{gray}\scriptsize\fontfamily{cmr}\selectfont,
	numbersep=8pt,
	tabsize=2,
	xleftmargin=19pt,
	framexleftmargin=15pt,
	framexrightmargin=-4pt
}


\lstdefinelanguage{modulelang}{
	morekeywords={resource, type, def, module, val, var}
}

\lstdefinestyle{cncstyle}{
	aboveskip=0pt,
	belowskip=-10pt,
	basicstyle=\footnotesize\ttfamily,
	captionpos=b,
	columns=flexible,
	float=t,
	frame=single,
	keywordstyle=\color{blue},
	numbers=left,
	numberstyle=\color{gray}\scriptsize\fontfamily{cmr}\selectfont,
	numbersep=8pt,
	tabsize=2,
	xleftmargin=19pt,
	framexleftmargin=15pt,
	framexrightmargin=-4pt
}

\lstdefinelanguage{cnclang}{
	morekeywords={component, port, connector, val, architecture, components, connectors, connections, connect, and, with, entryPoints}
}

\lstdefinestyle{allocationstyle}{
	aboveskip=0pt,
	belowskip=-10pt,
	basicstyle=\footnotesize\ttfamily,
	captionpos=b,
	columns=flexible,
	float=t,
	frame=single,
	keywordstyle=\color{blue},
	numbers=left,
	numberstyle=\color{gray}\scriptsize\fontfamily{cmr}\selectfont,
	numbersep=8pt,
	tabsize=2,
	xleftmargin=19pt,
	framexleftmargin=15pt,
	framexrightmargin=-4pt
}

\lstdefinelanguage{allocationlang}{
	morekeywords={deployment, extends}
}

\DeclareCaptionFormat{listing}{\textbf{#1.} #3}
\captionsetup[lstlisting]{format=listing}

% FIXME: Comment the following when you need to add copyright information.
\makeatletter
\def\@copyrightspace{\relax}
\makeatother

\begin{document}
\begin{sloppypar}

\special{papersize=8.5in,11in}
\setlength{\pdfpageheight}{\paperheight}
\setlength{\pdfpagewidth}{\paperwidth}

\conferenceinfo{CONF'yy}{Month d--d, 20yy, City, ST, Country}
\copyrightyear{20yy}
\copyrightdata{978-1-nnnn-nnnn-n/yy/mm}\reprintprice{\$15.00}
\copyrightdoi{nnnnnnn.nnnnnnn}

% For compatibility with auto-generated ACM eRights management
% instructions, the following alternate commands are also supported.
%\CopyrightYear{2016}
%\conferenceinfo{CONF'yy,}{Month d--d, 20yy, City, ST, Country}
%\isbn{978-1-nnnn-nnnn-n/yy/mm}\acmPrice{\$15.00}
%\doi{http://dx.doi.org/10.1145/nnnnnnn.nnnnnnn}

% Uncomment the publication rights used.
%\setcopyright{acmcopyright}
\setcopyright{acmlicensed}  % default
%\setcopyright{rightsretained}

%\titlebanner{banner above paper title}        % These are ignored unless
\preprintfooter{short description of paper}   % 'preprint' option specified.

%\title{Title Text\titlenote{with optional title note}}
\title{\langname: A Language for Multi-View Architecture Description and Control}
%\subtitle{Subtitle Text, if any\titlenote{with optional subtitle note}}

%\authorinfo{Name1\thanks{with optional author note}}
%           {Affiliation1}
%           {Email1}
%\authorinfo{Name2 \and Name3\thanks{with optional author note}}
%           {Affiliation2/3}
%           {Email2/3}
%\authorinfo{Selva Samuel}
%           {Carnegie Mellon University}
%           {ssamuel@cs.cmu.edu}
%\authorinfo{Madaline Kirwin}
%           {Grinnell College}
%           {kirwinma@grinnell.edu}
%\authorinfo{Jonathan Aldrich}
%           {Carnegie Mellon University}
%           {jonathan.aldrich@cs.cmu.edu}
\authorinfo{}{}{}

\maketitle

%\begin{abstract}
%This is the text of the abstract.
%\end{abstract}

% 2012 ACM Computing Classification System (CSS) concepts
% Generate at 'http://dl.acm.org/ccs/ccs.cfm'.
%\begin{CCSXML}
%<ccs2012>
%<concept>
%<concept_id>10011007.10011006.10011008</concept_id>
%<concept_desc>Software and its engineering~General programming languages</concept_desc>
%<concept_significance>500</concept_significance>
%</concept>
%<concept>
%<concept_id>10003752.10010124.10010138.10010143</concept_id>
%<concept_desc>Theory of computation~Program analysis</concept_desc>
%<concept_significance>300</concept_significance>
%</concept>
%</ccs2012>
%\end{CCSXML}

%\ccsdesc[500]{Software and its engineering~General programming languages}
%\ccsdesc[300]{Theory of computation~Program analysis}
% end generated code

% Legacy 1998 ACM Computing Classification System categories are also
% supported, but not recommended.
%\category{CR-number}{subcategory}{third-level}[fourth-level]
%\category{D.3.0}{Programming Languages}{General}
%\category{F.3.2}{Logics and Meanings of Programs}{Semantics of Programming Languages}[Program analysis]

%\keywords
%keyword1, keyword2

%\section{Introduction}

%The text of the paper begins here.

\section{Multiple Views of Software Architecture}

%\begin{itemize}
%\renewcommand\labelitemi{--}
%\item Give the SEI definition of software architecture
%\item State the usefulness of software architecture in analysis and design activities
%\item Introduce ADLs.
%\item Introduce views. State their usefulness in dealing with complexity by separating concerns
%\item State the lack of support for multiple views in ADLs.
%\item State that industry practitioners desire support for multiple views. Cite study by Malavolta et. al.
%\end{itemize}
The software architecture of a system is the set of structures needed to reason about the system, each consisting of elements of the system, relations among them, and properties of both \cite{Clements2010}. Software architecture enables the system designers to analyze the system's ability to meet quality objectives like performance, reliability, etc. Thus, it facilitates the early detection of design errors and leads to improved software quality. It also provides a blueprint for system implementation and evolution. 

To facilitate the different uses of software architecture in system development activities, a number of architecture description languages (ADLs) have been developed \cite{ADLs}. ADLs are formal languages that can be used to represent the architecture of a software system in an unambiguous way. Thus, they provide a rigorous basis for the analysis of system designs. ADLs also enable the various stakeholders to understand the system better and thus aid in system implementation, maintenance and evolution.

System designers often organize the architecture description of a software system as a set of views. An architectural view is a representation of those elements of the system that are needed to show how the architecture addresses a concern held by one or more stakeholders. For example, to devise an implementation plan, the system designers might create a (\moduleview) view that shows the module decomposition of the system and the dependencies among the modules (i.e., implementation units). Moreover, this view would not include the system's runtime entities or elements from the system's deployment environment. The separation of concerns achieved by splitting the architectural description into different views helps keep the architecture description cognitively tractable.

The vast majority of existing ADLs, however, lack support for multiple views. This hampers the use of ADLs for the specification of software architecture in practical settings. A survey conducted by \citeauthor{Malavolta2013} \cite{Malavolta2013} found that better support for multiple views is one of the features most desired by industrial practitioners in ADLs.

%This is a limitation. Low expressiveness.

%Software architecture has to address multiple concerns. Using a single model to reason about every concern would make it complex. To deal with this complexity, views are used.

%A view is a representation of one or more structural aspects of an architecture that illustrates how the architecture addresses one or more concerns held by one or more of its stakeholders.
%Most software architectures are implicit.

%UML

\section{Architectural Control}
%\begin{itemize}
%\renewcommand\labelitemi{--}
%\item What is architectural control? --$>$ Architectural constraints must be enforced in the implementation
%\item Introduce communication integrity
%\item Describe ArchJava's support for enforcing communication integrity in a single JVM and its failure to do so across multiple JVMs
%\end{itemize}

Software architects design systems to meet quality attribute requirements like performance, reliability, security, etc. To guarantee that the implemented system exhibits the desired quality attributes, it is necessary to ensure that the implementation adheres to the design principles and constraints prescribed by the architecture. Architectural control is the ability of software architects to enforce architectural constraints on the implementation so that the system meets its design goals.

\citeauthor{LV1995} have identified \textit{communication integrity} as a key aspect of maintaining consistency between the architecture and implementation of a software system \cite{LV1995}. Communication integrity is the property that each component in the implementation may communicate directly only with the components to which it is connected in the architecture.

In prior work, ArchJava used a custom type system to verify communication integrity statically \cite{Aldrich2002}. A limitation of ArchJava is its inability to ensure that an application communicates over the network using only the connections shown in the architecture. Since programs in ArchJava have unrestricted access to system libraries, a component can use the network library directly to communicate in ways not specified in the architecture.

\section{\langname}

We are developing \langname, an ADL that would allow software architects to describe the software architecture of a system using multiple views and to guarantee communication integrity even for applications that involve communication across processes, possibly over a network.

\noindent
\\
\textbf{Multi-View Architecture Description in \langname.} \citeauthor{Clements2010} \cite{Clements2010} identify three basic types of views: a) module view, b) component-and-connector view, and c) allocation view. Trinity provides support for these three views.

\noindent
\textit{\textbf{Module view.}} The module view is used to document the principal implementation units of a system, together with the relations among these units.

We have designed \langname{} to describe the architecture of systems implemented in the Wyvern programming language. Since Wyvern provides first-class modules \cite{Melicher2017} which can be instantiated, passed as arguments and returned from a function, we use module definitions in Wyvern to implicitly describe the module view by specifying the Wyvern modules that would be used for implementing the system and the dependencies among them.

For example, \lstlistingname{} \ref{moduleview} shows the module view of a client-server system. It consists of a \texttt{Client} module and a \texttt{Server} module. The \texttt{Client} module depends on a module instance of type \texttt{CSIface} and the \texttt{Server} module depends on a module instance of type \texttt{SPlumbing}.
%The primary elements in module view are implementation units that provide a coherent set of responsibilities. In \langname, implementation units take the form of capability-based modules.

%Every module has a collection of properties associated with it. These properties are intended to express the important information associated with the module, as well as constraints on the module. Sample properties are responsibilities, visibility information, and author or owner.

%Modules are related to one another using the depends on relation.

%What is a module view useful for? The module view can be used to determine how a system's source code is decomposed into units, what assumptions each unit can make about services provided by other units, and how these units are aggregated into larger ensembles. The module view can thus be used to create an implementation plan and also to determine how changes to one part of a system might affect other parts and thus reason about the system's modifiability, portability and reuse.

\begin{lstlisting}[style=modulestyle, caption=Module view of a client/server system, label=moduleview, language=modulelang, belowcaptionskip=0pt]
resource type CSIface
	def getVal(key: String): String
module def Client(cPlumbing: CSIface): ClientIface
	def startClient(): Unit
		...
module def Server(sPlumb: SPlumbing): ServerIface
	module def sendInfo(): CSIface
		def getVal(key: String): String
			...
	def startServer(): Unit
		sPlumb.setFn(sendInfo().getVal)
		...
\end{lstlisting}

\noindent
\textit{\textbf{Component-and-connector view.}} The component-and-connector (C\&C) view expresses runtime behavior. \lstlistingname{} \ref{cncview} shows the C\&C view of our example client-server system. It consists of two \textit{components} (i.e. processes): a \texttt{client} component of component type \texttt{Client} and a \texttt{server} component of component type \texttt{Client}.

Components have \textit{ports} which are interfaces through which a component interacts with the components it is connected to. A \texttt{provides} port consists of methods that are implemented by the component, while a \texttt{requires} port consists of methods that must be implemented by a component connected to this port.

For components to interact with each other, they must be connected together with a \textit{connector}. In \lstlistingname{} \ref{cncview}, the \texttt{client} and \texttt{server} components interact via the \texttt{jsonCtr} connector. The \texttt{jsonCtr} connector enables the \texttt{client} and \texttt{server} components to communicate by passing JSON data between each other.
%The \texttt{Client} and \texttt{Server} component types correspond to the \texttt{Client} and \texttt{Server} modules in the module view respectively.
%It is described in terms of components and connectors. A component is one of the principal processing units of the executing system. Components might be services, processes, threads, filters, repositories, peers, or clients and servers, to name a few. A connector is the interaction mechanism among components. Connectors include pipes, queues, request/reply protocols, direct invocation, event-driven invocation, etc. Components and connectors can be decomposed into other components and connectors. The decomposition of a component may include connectors and vice versa.

\begin{lstlisting}[style=cncstyle, caption=C\&C view of the client/server system, label=cncview, language=cnclang, belowcaptionskip=0pt]
component Client
	port getInfo: requires CSIface
component Server
	port sendInfo: provides CSIface
connector JSONCtr
	val host: IPAddress
	val prt: Int
architecture ClientServer
	components
		Client client
		Server server
	connectors
		JSONCtr jsonCtr
	connections
		connect client.getInfo and server.sendInfo
			with jsonCtr
\end{lstlisting}
%
%	entryPoints
%		client: startClient
%		server: startServer

\noindent
\textit{\textbf{Allocation view.}} Allocation view describes the mapping of software units to elements of an environment in which the software executes. In particular, software elements from the C\&C view are allocated to the hardware of the computing platform on which the software executes. For example, \lstlistingname{} \ref{allocationview} shows the allocation view for our client-server system. It specifies the IP address and port of the \texttt{server} component connected by the \texttt{jsonCtr} connector.
%The environment might be the hardware, the file systems supporting development or deployment, or the development organization(s).

\begin{lstlisting}[style=allocationstyle, caption=Allocation view of the client/server system, label=allocationview, language=allocationlang, belowcaptionskip=0pt]
deployment CSDeployment extends ClientServer
	jsonCtr.host = 192.168.1.1
	jsonCtr.prt = 9090
\end{lstlisting}

\begin{lstlisting}[style=modulestyle, caption=Plumbing code generated for the client, label=clientplumbing, language=modulelang, belowcaptionskip=-5pt]
module def cPlumbing(tcpClient: TCPClient): CSIface
	def getVal(key: String): String
		tcpClient.connect(IPAddress("192.168.1.1"),9090)
		...

val tcpClient = TCPClient()
val plumbing = cPlumbing(tcpClient)
val client = Client(plumbing)
c.startClient()
\end{lstlisting}

\noindent
\\
\textbf{Architectural Control in \langname.} Communication integrity is guaranteed in \langname{} by means of the non-transitive authority property of Wyvern's capability-based module system \cite{Melicher2017}. For example, \lstlistingname{} \ref{clientplumbing} shows the plumbing code generated for the \texttt{client} component from the architecture description to facilitate its communication with the \texttt{server} component using the \texttt{jsonCtr} connector. Note in lines 6 to 8 that the \texttt{Client} module does not have a direct reference to the \texttt{TCPClient} module. Since authority is non-transitive in Wyvern, therefore the \texttt{Client} module would not be able to call the \texttt{connect} method of the \texttt{TCPClient} module. Thus, it would not be able to make connections to arbitrary hosts over the network.

%\appendix
%\section{Appendix Title}

%This is the text of the appendix, if you need one.

%\acks

%Acknowledgments, if needed.

% The 'abbrvnat' bibliography style is recommended.

\bibliographystyle{abbrvnat}
\bibliography{references.bib}

% The bibliography should be embedded for final submission.

%\begin{thebibliography}{}
%\softraggedright

%\bibitem[Smith et~al.(2009)Smith, Jones]{smith02}
%P. Q. Smith, and X. Y. Jones. ...reference text...

%\end{thebibliography}


\end{sloppypar}
\end{document}
